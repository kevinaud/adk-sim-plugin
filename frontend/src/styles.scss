/* ==========================================================================
   Angular Material Theme Configuration
   SCSS @use rules must come first (before any @layer or @import)
   ========================================================================== */

@use './theme';

/* ==========================================================================
   Tailwind CSS + Angular Material Integration
   Using granular imports to avoid Preflight conflicts with Material
   ========================================================================== */

/* A. Define CSS Layers for proper cascade ordering */
@layer theme, base, components, utilities;

/* B. Import Tailwind Core Modules (Skipping Preflight) */
@import 'tailwindcss/theme.css' layer(theme);
@import 'tailwindcss/utilities.css' layer(utilities);

/* C. Configure Sources for Monorepo */
@source './app';
@source '../../packages';

/* ==========================================================================
   Theme Bridge: Map Material System Variables to Tailwind
   This makes Angular Material the single source of truth for design tokens
   ========================================================================== */

@theme {
  /* Primary colors */
  --color-primary: var(--sys-primary);
  --color-on-primary: var(--sys-on-primary);
  --color-primary-container: var(--sys-primary-container);
  --color-on-primary-container: var(--sys-on-primary-container);

  /* Secondary colors */
  --color-secondary: var(--sys-secondary);
  --color-on-secondary: var(--sys-on-secondary);
  --color-secondary-container: var(--sys-secondary-container);
  --color-on-secondary-container: var(--sys-on-secondary-container);

  /* Tertiary colors */
  --color-tertiary: var(--sys-tertiary);
  --color-on-tertiary: var(--sys-on-tertiary);
  --color-tertiary-container: var(--sys-tertiary-container);
  --color-on-tertiary-container: var(--sys-on-tertiary-container);

  /* Surface colors */
  --color-surface: var(--sys-surface);
  --color-on-surface: var(--sys-on-surface);
  --color-surface-variant: var(--sys-surface-variant);
  --color-on-surface-variant: var(--sys-on-surface-variant);
  --color-surface-container: var(--sys-surface-container);
  --color-surface-container-low: var(--sys-surface-container-low);
  --color-surface-container-high: var(--sys-surface-container-high);
  --color-surface-container-highest: var(--sys-surface-container-highest);

  /* Background and inverse */
  --color-background: var(--sys-background);
  --color-on-background: var(--sys-on-background);
  --color-inverse-surface: var(--sys-inverse-surface);
  --color-inverse-on-surface: var(--sys-inverse-on-surface);
  --color-inverse-primary: var(--sys-inverse-primary);

  /* Error colors */
  --color-error: var(--sys-error);
  --color-on-error: var(--sys-on-error);
  --color-error-container: var(--sys-error-container);
  --color-on-error-container: var(--sys-on-error-container);

  /* Semantic status colors for UI indicators */
  /* These extend Material's color system with common status semantics */
  --color-success: #22c55e; /* Green 500 - for positive/success states */
  --color-warning: #f59e0b; /* Amber 500 - for warning/attention states */

  /* Role-based colors (defined in theme.scss with light/dark variants) */
  --color-role-user: var(--color-role-user);
  --color-role-model: var(--color-role-model);
  --color-role-tool: var(--color-role-tool);
  --color-role-user-surface: var(--color-role-user-surface);
  --color-role-model-surface: var(--color-role-model-surface);
  --color-role-tool-surface: var(--color-role-tool-surface);

  /* Semantic accents */
  --color-success-accent: var(--color-success-accent);
  --color-success-surface: var(--color-success-surface);
  --color-warning-accent: var(--color-warning-accent);
  --color-warning-on: var(--color-warning-on);
  --color-action-accent: var(--color-action-accent);

  /* Outline */
  --color-outline: var(--sys-outline);
  --color-outline-variant: var(--sys-outline-variant);

  /* Typography */
  --font-sans: Roboto, 'Helvetica Neue', sans-serif;
}

/* ==========================================================================
   Material-Safe Reset (Base Layer)
   Only includes essential resets that don't conflict with Angular Material
   ========================================================================== */

@layer base {
  /* 1. Essential Box Sizing (Required for all modern layouts) */
  *,
  ::after,
  ::before {
    box-sizing: border-box;
  }

  /* 2. Restore Standard HTML Behavior */
  /* Material handles most of this, but this keeps non-material elements sane */
  html {
    line-height: 1.5;
    -webkit-text-size-adjust: 100%;
    tab-size: 4;
  }

  /* 3. Explicitly preserve heading styles for Dialogs/Cards */
  /* Prevents Preflight-like heading reset that would break mat-card-title, etc. */
  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    font-size: revert;
    font-weight: revert;
  }
}

/* ==========================================================================
   Global Styles
   ========================================================================== */

html,
body {
  height: 100%;
  margin: 0;
  font-family: Roboto, 'Helvetica Neue', sans-serif;
  /* Use theme bridge surface color - auto-updates with dark mode */
  background-color: var(--sys-surface);
  color: var(--sys-on-surface);
}

/* ==========================================================================
   JSON Syntax Highlighting (for innerHTML content in DataTree)
   These styles must be global because they target dynamically inserted HTML.
   Uses unique class names (json-*) to avoid conflicts.
   ========================================================================== */

.json-key {
  color: #c586c0 !important; /* Purple/magenta for keys */
}

.json-string {
  color: #6a9955 !important; /* Green for strings */
}

.json-number {
  color: #4ec9b0 !important; /* Teal/cyan for numbers */
}

.json-boolean {
  color: #569cd6 !important; /* Blue for booleans */
}

.json-null {
  color: #569cd6 !important; /* Blue for null */
  font-style: italic;
}

.json-bracket {
  color: inherit;
}
